#!/usr/bin/env bash

PROJECT_PATH="$(
    cd "$(dirname "$0")/.."
    pwd
)"


print_usage() {
    echo "Usage:"
    echo "  run seed-clickhouse"
    echo ""
}

case "$1" in
'seed-mysql-qc')
    docker exec -i backend-mysql mysql -uroot -psecret CoccocAds < mysql/schemas/qc-site/region_table.sql
    echo "seeded sql region table"
    docker exec -i backend-mysql mysql -uroot -psecret CoccocAds < mysql/schemas/qc-site/transaction_type_mapping_table.sql
    echo "seeded sql transaction type mapping table"
    docker exec -i backend-mysql mysql -uroot -psecret CoccocAds < mysql/schemas/qc-site/dump_views.sql
    echo "seeded sql views"
    ;;

'seed-clickhouse-qc')
    cat clickhouse/qc-site/labs_external_mysql/*.sql | docker exec -i backend-clickhouse clickhouse-client --host clickhouse  --port 9002 --multiquery
    echo "seeded labs_external_mysql"

    cat clickhouse/qc-site/labs_statistics/*.sql | docker exec -i backend-clickhouse clickhouse-client --host clickhouse  --port 9002 --multiquery
    echo "seeded labs_statistics"

    cat clickhouse/qc-site/labs_activity_logs/*.sql | docker exec -i backend-clickhouse clickhouse-client --host clickhouse  --port 9002 --multiquery
    echo "seeded labs_activity_logs"
    ;;

'seed-clickhouse-adnetwork')
    cat clickhouse/adnetwork/labs_statistics/*.sql | docker exec -i backend-clickhouse clickhouse-client --host clickhouse  --port 9002 --multiquery
    echo "seeded labs_statistics"
    ;;

'--help')
    echo "Run tools from docker containers."
    echo ""
    print_usage
    ;;

*)
    echo "Invalid command: $1"
    echo ""
    print_usage
    exit 1
    ;;
esac

